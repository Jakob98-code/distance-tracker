<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#0b0f17">
  <meta name="description" content="Real-time distance tracker for long-distance relationships">
  <title>Distance Doesn't Matter ğŸ«¶</title>
  
  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <link rel="icon" href="icons/icon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="icons/icon.svg">
  
  <!-- Styles -->
  <link rel="stylesheet" href="style.css">
  
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-database-compat.js"></script>
</head>
<body>
  <!-- Decorative Tulips -->
  <div class="tulip-decoration tulip-left">
    <svg viewBox="0 0 60 120" class="tulip-svg">
      <!-- Stem -->
      <path class="tulip-stem" d="M30 120 Q30 80 28 60 Q26 40 30 35" stroke="#4ade80" stroke-width="3" fill="none" stroke-linecap="round"/>
      <!-- Leaves -->
      <path class="tulip-leaf tulip-leaf-left" d="M28 75 Q15 70 10 85 Q15 80 28 75" fill="#4ade80"/>
      <path class="tulip-leaf tulip-leaf-right" d="M30 65 Q45 60 48 75 Q43 68 30 65" fill="#4ade80"/>
      <!-- Petals -->
      <ellipse class="tulip-petal petal-1" cx="30" cy="22" rx="8" ry="18" fill="#fff"/>
      <ellipse class="tulip-petal petal-2" cx="22" cy="24" rx="7" ry="16" fill="#f8f8f8"/>
      <ellipse class="tulip-petal petal-3" cx="38" cy="24" rx="7" ry="16" fill="#f8f8f8"/>
    </svg>
  </div>
  
  <div class="tulip-decoration tulip-right">
    <svg viewBox="0 0 60 120" class="tulip-svg">
      <!-- Stem -->
      <path class="tulip-stem" d="M30 120 Q30 80 32 60 Q34 40 30 35" stroke="#4ade80" stroke-width="3" fill="none" stroke-linecap="round"/>
      <!-- Leaves -->
      <path class="tulip-leaf tulip-leaf-left" d="M30 70 Q17 65 12 80 Q17 73 30 70" fill="#4ade80"/>
      <path class="tulip-leaf tulip-leaf-right" d="M32 60 Q47 55 52 70 Q45 62 32 60" fill="#4ade80"/>
      <!-- Petals -->
      <ellipse class="tulip-petal petal-1" cx="30" cy="22" rx="8" ry="18" fill="#fff"/>
      <ellipse class="tulip-petal petal-2" cx="22" cy="24" rx="7" ry="16" fill="#f8f8f8"/>
      <ellipse class="tulip-petal petal-3" cx="38" cy="24" rx="7" ry="16" fill="#f8f8f8"/>
    </svg>
  </div>

  <!-- Auth Screen -->
  <div id="auth-screen" class="auth-screen hidden">
    <div class="auth-container">
      <div class="auth-icon">ğŸ«¶</div>
      <h1 class="auth-title">Distance Doesn't Matter</h1>
      <p class="auth-subtitle">Sign in to access your tracker</p>
      
      <div id="auth-form" class="auth-form">
        <div class="form-group">
          <label for="auth-email">Email</label>
          <input type="email" id="auth-email" placeholder="your@email.com" autocomplete="email">
        </div>
        <div class="form-group">
          <label for="auth-password">Password</label>
          <input type="password" id="auth-password" placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" autocomplete="current-password">
        </div>
        <div id="auth-error" class="auth-error hidden"></div>
        <button id="auth-signin-btn" class="btn btn-primary btn-full">Sign In</button>
        <button id="auth-signup-btn" class="btn btn-secondary btn-full">Create Account</button>
      </div>
      
      <p class="auth-footer">Your data is protected with end-to-end security ğŸ”’</p>
    </div>
  </div>

  <!-- PIN Lock Screen -->
  <div id="pin-lock-screen" class="pin-lock-screen hidden">
    <div class="pin-container">
      <div class="pin-icon">ğŸ”’</div>
      <h2 id="pin-title">Enter PIN</h2>
      <p id="pin-subtitle" class="pin-subtitle">Enter your 4-digit PIN to unlock</p>
      <div class="pin-dots" id="pin-dots">
        <span class="pin-dot"></span>
        <span class="pin-dot"></span>
        <span class="pin-dot"></span>
        <span class="pin-dot"></span>
      </div>
      <div id="pin-error" class="pin-error hidden">Incorrect PIN. Try again.</div>
      <div class="pin-keypad">
        <button class="pin-key" data-key="1">1</button>
        <button class="pin-key" data-key="2">2</button>
        <button class="pin-key" data-key="3">3</button>
        <button class="pin-key" data-key="4">4</button>
        <button class="pin-key" data-key="5">5</button>
        <button class="pin-key" data-key="6">6</button>
        <button class="pin-key" data-key="7">7</button>
        <button class="pin-key" data-key="8">8</button>
        <button class="pin-key" data-key="9">9</button>
        <button class="pin-key pin-key-empty"></button>
        <button class="pin-key" data-key="0">0</button>
        <button class="pin-key pin-key-delete" data-key="delete">âŒ«</button>
      </div>
    </div>
  </div>

  <div class="container hidden" id="main-app">
    <!-- Header -->
    <header class="header">
      <h1 class="title">Distance Doesn't Matter <span class="heart">ğŸ«¶</span></h1>
      <p class="subtitle">Real-time tracker for <span id="person1-name">Jakob</span> & <span id="person2-name">â¤ï¸</span></p>
    </header>

    <!-- Setup Panel (shown first time) -->
    <div id="setup-panel" class="card setup-panel hidden">
      <h2>ğŸ”§ First Time Setup</h2>
      <p>Configure your Firebase project and names:</p>
      
      <div class="form-group">
        <label for="firebase-config">Firebase Config (paste JSON):</label>
        <textarea id="firebase-config" rows="6" placeholder='{
  "apiKey": "your-api-key",
  "authDomain": "your-project.firebaseapp.com",
  "databaseURL": "https://your-project-default-rtdb.firebaseio.com",
  "projectId": "your-project"
}'></textarea>
      </div>
      
      <div class="form-row">
        <div class="form-group">
          <label for="setup-person1">Your Name:</label>
          <input type="text" id="setup-person1" placeholder="Jakob">
        </div>
        <div class="form-group">
          <label for="setup-person2">Partner's Name:</label>
          <input type="text" id="setup-person2" placeholder="â¤ï¸">
        </div>
      </div>
      
      <div class="form-group">
        <label for="setup-couple-id">Unique Couple ID:</label>
        <input type="text" id="setup-couple-id" placeholder="jakob-emma-2025">
        <small>Share this ID with your partner so you both connect to the same tracker</small>
      </div>
      
      <div class="form-group">
        <label for="setup-who">Who are you?</label>
        <select id="setup-who">
          <option value="person1">Person 1 (first name)</option>
          <option value="person2">Person 2 (partner)</option>
        </select>
      </div>
      
      <button id="save-setup" class="btn btn-primary">Save & Start Tracking</button>
    </div>

    <!-- Connection Status -->
    <div id="connection-status" class="connection-status">
      <span class="status-dot"></span>
      <span class="status-text">Connecting...</span>
    </div>

    <!-- Map -->
    <div class="card map-card">
      <div id="map"></div>
    </div>

    <!-- Main Stats -->
    <div class="card stats-card">
      <div class="stats-grid">
        <div class="stat stat-distance">
          <div class="stat-label" id="distance-label">Our distance: -- km</div>
          <div class="distance-visual">
            <span class="distance-initial" id="initial-1">J</span>
            <div class="distance-connector">
              <span class="distance-line"></span>
              <span class="distance-heart">ğŸ’•</span>
              <span class="distance-line"></span>
            </div>
            <span class="distance-initial" id="initial-2">D</span>
          </div>
          <div class="distance-message" id="distance-message"></div>
        </div>
        <div class="stat">
          <div class="stat-label">Days Together</div>
          <div class="stat-value" id="days-together">--</div>
        </div>
        <div class="stat">
          <div class="stat-label">Next Meet</div>
          <div class="stat-value" id="days-until-meet">Soon âœ¨</div>
        </div>
      </div>
    </div>

    <!-- Location Cards -->
    <div class="locations-grid">
      <!-- Person 1 -->
      <div class="card location-card">
        <div class="location-header">
          <span class="location-emoji">ğŸ“</span>
          <span class="location-name" id="person1-label">Jakob</span>
        </div>
        <div class="location-coords" id="person1-coords">Waiting for location...</div>
        <div class="location-city" id="person1-city"></div>
        <div class="location-updated" id="person1-updated">--</div>
      </div>
      
      <!-- Person 2 -->
      <div class="card location-card">
        <div class="location-header">
          <span class="location-emoji">ğŸ“</span>
          <span class="location-name" id="person2-label">Partner</span>
        </div>
        <div class="location-coords" id="person2-coords">Waiting for location...</div>
        <div class="location-city" id="person2-city"></div>
        <div class="location-updated" id="person2-updated">--</div>
      </div>
    </div>

    <!-- Controls -->
    <div class="card controls-card">
      <button id="update-location" class="btn btn-primary">
        ğŸ“ Update My Location
      </button>
      <button id="toggle-tracking" class="btn btn-secondary">
        ğŸ”„ Start Auto-Tracking
      </button>
      <button id="show-settings" class="btn btn-ghost">
        âš™ï¸ Settings
      </button>
      <button id="sign-out-btn" class="btn btn-ghost">
        ğŸšª Sign Out
      </button>
    </div>

    <!-- Love Note -->
    <div class="card love-card">
      <p class="love-note">Distance is just a number.<br>What matters is that I choose you â€” every day.</p>
      <p class="love-footer">P.S. If distance is a number, then my love is an invariant. â¤ï¸</p>
    </div>

    <!-- Install Prompt -->
    <div id="install-prompt" class="install-prompt hidden">
      <p>ğŸ“± Install this app on your phone for quick access!</p>
      <button id="install-btn" class="btn btn-primary">Install App</button>
      <button id="dismiss-install" class="btn btn-ghost">Maybe Later</button>
    </div>
  </div> <!-- end main-app -->

  <!-- Leaflet for maps (free, no API key needed) -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  
  <script src="app.js"></script>
</body>
</html>
